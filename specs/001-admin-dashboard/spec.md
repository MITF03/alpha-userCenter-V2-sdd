# Feature Specification: 後台管理系統

**Feature Branch**: `001-admin-dashboard`  
**Created**: 2025-01-27  
**Status**: Draft  
**Input**: User description: "我希望建立一個後台系統 主要是查看客戶的投資狀況 跟 退休金試算 然後要建立一個登入系統 裡面包含第三方登入 line 跟 google"

## User Scenarios & Testing _(mandatory)_

### User Story 1 - 第三方登入系統 (Priority: P1)

管理員需要能夠使用 LINE 或 Google 帳號登入後台系統，以安全地存取客戶資料與功能。

**Why this priority**: 登入系統是所有後台功能的基礎，必須先建立才能讓管理員使用其他功能。第三方登入提供便利性與安全性，減少密碼管理的負擔。

**Independent Test**: 可以透過以下方式獨立測試：管理員使用 LINE 或 Google 帳號成功登入系統，獲得適當的存取權限，並能在登入後看到後台主頁面。此功能可獨立部署並提供價值，即使其他功能尚未完成。

**Acceptance Scenarios**:

1. **Given** 管理員尚未登入系統, **When** 點擊「使用 LINE 登入」按鈕, **Then** 系統導向 LINE 授權頁面，管理員完成授權後自動登入並導向後台主頁面
2. **Given** 管理員尚未登入系統, **When** 點擊「使用 Google 登入」按鈕, **Then** 系統導向 Google 授權頁面，管理員完成授權後自動登入並導向後台主頁面
3. **Given** 管理員已登入系統, **When** 點擊「登出」按鈕, **Then** 系統清除登入狀態並導向登入頁面
4. **Given** 管理員嘗試存取受保護的頁面但尚未登入, **When** 系統偵測到未授權存取, **Then** 系統自動導向登入頁面
5. **Given** 管理員使用第三方帳號首次登入, **When** 系統驗證帳號資訊, **Then** 系統自動建立管理員帳號並授予適當權限

---

### User Story 2 - 查看客戶投資狀況 (Priority: P2)

管理員需要能夠查看所有客戶的投資狀況，包括投資組合、投資金額、投資標的與投資績效等資訊。

**Why this priority**: 這是後台系統的核心功能之一，讓管理員能夠監控與管理客戶的投資情況，提供客戶服務與風險管理。

**Independent Test**: 可以透過以下方式獨立測試：管理員登入後，能夠瀏覽客戶列表，選擇特定客戶查看其投資狀況，包括投資組合明細、投資金額、投資標的與績效數據。此功能可獨立運作，即使退休金試算功能尚未完成。

**Acceptance Scenarios**:

1. **Given** 管理員已登入系統, **When** 進入「客戶投資狀況」頁面, **Then** 系統顯示所有客戶列表，包含客戶姓名、總投資金額、投資標的數量等摘要資訊
2. **Given** 管理員在客戶列表頁面, **When** 點擊特定客戶, **Then** 系統顯示該客戶的詳細投資狀況，包括投資組合、各標的投資金額、投資日期、目前績效等
3. **Given** 管理員在客戶投資狀況頁面, **When** 使用搜尋功能輸入客戶姓名或編號, **Then** 系統過濾並顯示符合條件的客戶
4. **Given** 管理員查看客戶投資狀況, **When** 需要查看特定時間區間的投資記錄, **Then** 系統提供日期篩選功能，顯示該期間的投資變動
5. **Given** 管理員查看客戶投資狀況, **When** 需要匯出資料, **Then** 系統提供匯出功能，可匯出為標準格式（如 CSV 或 PDF）

---

### User Story 3 - 退休金試算功能 (Priority: P3)

管理員需要能夠為客戶進行退休金試算，根據客戶的投資狀況、預期報酬率與退休目標，計算預估的退休金金額。

**Why this priority**: 這是進階功能，提供客戶諮詢服務的支援工具。雖然重要，但可以在基本投資狀況查看功能完成後再實作。

**Independent Test**: 可以透過以下方式獨立測試：管理員選擇客戶後，輸入退休相關參數（如退休年齡、預期報酬率、每月投資金額等），系統計算並顯示預估退休金金額與相關分析。此功能可獨立運作，提供完整的試算價值。

**Acceptance Scenarios**:

1. **Given** 管理員已登入並選擇客戶, **When** 進入「退休金試算」功能, **Then** 系統顯示試算表單，包含客戶基本資訊與可調整的試算參數
2. **Given** 管理員在試算表單中, **When** 輸入退休年齡、預期報酬率、每月投資金額等參數, **Then** 系統即時計算並顯示預估退休金金額與相關圖表
3. **Given** 管理員完成試算, **When** 需要儲存試算結果, **Then** 系統提供儲存功能，將試算結果與參數儲存供後續參考
4. **Given** 管理員需要比較不同情境, **When** 調整試算參數（如不同報酬率或投資金額）, **Then** 系統顯示多種情境的比較結果，幫助管理員與客戶討論
5. **Given** 管理員完成試算, **When** 需要列印或分享試算結果, **Then** 系統提供列印與匯出功能，可產生試算報告

---

### Edge Cases

- 當第三方登入服務（LINE 或 Google）暫時無法使用時，系統如何處理？
- 當客戶沒有投資記錄時，投資狀況頁面如何顯示？
- 當試算參數不合理（如負數、過大數值）時，系統如何驗證與提示？
- 當管理員同時使用多個裝置登入時，系統如何管理登入狀態？
- 當客戶資料量非常大時，系統如何確保查詢與顯示的效能？
- 當第三方登入授權被撤銷時，系統如何處理後續登入請求？

## Requirements _(mandatory)_

### Functional Requirements

- **FR-001**: 系統必須支援 LINE 第三方登入，允許管理員使用 LINE 帳號進行身份驗證
- **FR-002**: 系統必須支援 Google 第三方登入，允許管理員使用 Google 帳號進行身份驗證
- **FR-003**: 系統必須在管理員成功登入後建立並維護登入工作階段，確保後續操作的身份驗證
- **FR-004**: 系統必須在管理員登出時清除登入狀態，確保安全性
- **FR-005**: 系統必須保護所有後台頁面，未登入的管理員無法存取
- **FR-006**: 系統必須顯示所有客戶的投資狀況列表，包含客戶基本資訊與投資摘要
- **FR-007**: 系統必須提供客戶詳細投資狀況查看功能，顯示完整的投資組合、投資標的、投資金額與績效資訊
- **FR-008**: 系統必須提供客戶搜尋功能，允許管理員根據客戶姓名或編號快速找到特定客戶
- **FR-009**: 系統必須提供投資記錄的時間篩選功能，允許管理員查看特定時間區間的投資變動
- **FR-010**: 系統必須提供投資狀況資料匯出功能，支援標準格式（CSV 或 PDF）
- **FR-011**: 系統必須提供退休金試算功能，允許管理員輸入參數並計算預估退休金
- **FR-012**: 系統必須在試算參數變更時即時更新試算結果
- **FR-013**: 系統必須提供試算結果儲存功能，保存試算參數與結果供後續參考
- **FR-014**: 系統必須提供多情境試算比較功能，允許管理員比較不同參數組合的結果
- **FR-015**: 系統必須提供試算報告列印與匯出功能
- **FR-016**: 系統必須驗證所有使用者輸入，確保資料正確性與合理性
- **FR-017**: 系統必須記錄所有管理員操作，包括登入、登出與重要資料存取，供稽核使用
- **FR-018**: 系統必須在發生錯誤時顯示友善的錯誤訊息，協助管理員理解問題並採取適當行動

### Key Entities _(include if feature involves data)_

- **管理員 (Administrator)**: 使用後台系統的人員，透過第三方登入進行身份驗證，具有查看客戶資料與使用試算功能的權限。關鍵屬性包括：登入識別碼、第三方帳號資訊、登入時間、權限等級
- **客戶 (Customer)**: 投資服務的使用者，其投資資料由管理員在後台查看與管理。關鍵屬性包括：客戶編號、姓名、聯絡資訊、投資記錄、投資組合
- **投資記錄 (Investment Record)**: 客戶的單筆投資交易記錄，包含投資標的、投資金額、投資日期、目前價值等資訊
- **投資組合 (Investment Portfolio)**: 客戶的整體投資組合，包含多個投資標的與其配置比例
- **試算結果 (Calculation Result)**: 退休金試算的結果，包含輸入參數、計算結果、試算日期等資訊

## Success Criteria _(mandatory)_

### Measurable Outcomes

- **SC-001**: 管理員能夠在 30 秒內完成第三方登入流程（從點擊登入按鈕到進入後台主頁面）
- **SC-002**: 系統能夠在 3 秒內顯示客戶投資狀況列表，即使客戶數量達到 1000 筆
- **SC-003**: 管理員能夠在 5 秒內找到並查看特定客戶的詳細投資狀況
- **SC-004**: 系統能夠在 2 秒內完成退休金試算計算並顯示結果
- **SC-005**: 95% 的管理員能夠在首次使用時成功完成登入流程，無需額外協助
- **SC-006**: 系統能夠同時支援至少 50 位管理員同時使用，不會出現效能問題
- **SC-007**: 所有資料查詢與試算功能在正常使用情況下，錯誤率低於 1%
- **SC-008**: 管理員對系統整體滿意度達到 80% 以上（透過使用者滿意度調查）
